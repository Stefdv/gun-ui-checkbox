<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../gun-ui-mixin/gun-ui-mixin.html">
<link rel="import" href="../paper-checkbox/paper-checkbox.html">
<!--
`gun-ui-checkbox`
Part of the GunUi elements

@demo demo/index.html
-->

<dom-module id="gun-ui-checkbox">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>
    <paper-checkbox
      disabled$="[[disabled]]"
      noink$="[[noink]]"
      checked$="{{checked}}"
      on-change="_userAction">
      
    </paper-checkbox>
  </template>

  <script>
    Polymer({

      is: 'gun-ui-checkbox',

      properties: {
        disabled: {
          type: Boolean,
          value: false
        },
        noink:{
          type: Boolean,
          value: false
        },
        checked:{
          type: Boolean,
          value: false,

        },

      },
      behaviors:[Polymer.GunUiMixin],
      ready() {
        this.subscribe ? this._subscribe() : this._getCurrent()
      },
       _subscribe() {
        if(this.soul && this.prop) {
         this._on({soul:this.soul,prop:this.prop},(c)=>{
             this.checked = c ? c :false
          })

        } else {
          console.warn('You have no soul and/or prop set !!');
        };
      },
      _getCurrent(){
       this._read({soul:this.soul,prop:this.prop})
            .then( (value) => {
              this.checked = value ? value:false;
            })     
      },
      _userAction(e){
        this.setValue(e.target.checked)
       
      },
      /* update Gun */
      setValue(val) {
        if(this.soul) {
          this._update({soul:this.soul,prop:this.prop,data:val})
        };
      },


    });
  </script>
</dom-module>
